// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // Make sure to set this in your .env
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  role      Role     @default(USER)
  calls     Call[]
  activities Activity[] @relation("UserActivities") // Add this line
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Call {
  id             String      @id @unique
  clientName     String
  reference      String
  createdAt      DateTime @default(now())
  duration       Int      // Duration in seconds
  status         String   // e.g., 'completed', 'failed'
  initiatedById  Int
  reasonFailed   String?  // Optional reason if the call failed
  recordingUrl   String?  // Optional recording URL
  user           User     @relation(fields: [initiatedById], references: [id])
  callTypeId     Int
  callType       CallType  @relation(fields: [callTypeId], references: [id])
}

model CallType {
  id       Int      @id @default(autoincrement())
  type     String   @unique
  calls    Call[]
}

model Activity {
  id         Int      @id @default(autoincrement())
  userId     Int
  action     String   // e.g., 'user created', 'call initiated'
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id], name: "UserActivities")
}

enum Role {
  USER
  ADMIN
  SUPERVISOR
}
